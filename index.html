<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <style>
        .liberado {
            background-color: green;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        .emAtendimento {
            background-color: red;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        .acoes {
            display: none;
            font-size: 20px;
        }
        tr.selecionado .acoes {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <table id="tabela" class="table table-striped">
            <thead>
                <tr>
                    <th>Empresa</th>
                    <th>Liberado/Em Atendimento</th>
                    <th>Login</th>
                    <th>Observação</th>
                    <th class='acoes'>Ações</th>
                </tr>
            </thead>
            <tbody>
                <tr onclick='selecionar(this)'>
                    <td contenteditable='true'>Empresa 1</td>
                    <td class='statusCell'>
                        <select class='status' onchange='atualizarStatus(this)'>
                            <option value='Liberado'>Liberado</option>
                            <option value='Em Atendimento'>Em Atendimento</option>
                        </select>
                    </td>
                    <td contenteditable='true'>Login 1</td>
                    <td contenteditable='true'>Observação 1</td>
                    <td class='acoes'>
                        <button class="btn btn-primary" onclick='editar(this)'>OK</button>
                        <button class="btn btn-danger" onclick='excluir(this)'>Excluir</button>
                    </td>
                </tr>
            </tbody>
        </table>
        <button class="btn btn-success" onclick='adicionar()'>Adicionar Empresa</button>
    </div>

    <script>
        function atualizarStatus(elemento) {
            var linha = elemento.parentNode.parentNode.parentNode;
            var statusCell = linha.getElementsByClassName('statusCell')[0];
            if (elemento.value == 'Liberado') {
                linha.className = 'liberado';
            } else if (elemento.value == 'Em Atendimento') {
                linha.className = 'emAtendimento';
            }
            statusCell.innerText = elemento.value;
        }

        function selecionar(linha) {
            linha.classList.add('selecionado');
        }

        function excluir(elemento) {
            var linha = elemento.parentNode.parentNode;
            linha.parentNode.removeChild(linha);
        }

        function adicionar() {
            var tabela = document.getElementById('tabela').getElementsByTagName('tbody')[0];
            var linha = tabela.insertRow(-1);
            linha.onclick = function() { selecionar(this); };
            var celulaEmpresa = linha.insertCell(-1);
            celulaEmpresa.contentEditable = 'true';
            var celulaStatus = linha.insertCell(-1);
            celulaStatus.className = 'statusCell';
            var select = document.createElement('select');
            select.className = 'status';
            select.onchange = function() { atualizarStatus(this); };
            var opcaoLiberado = document.createElement('option');
            opcaoLiberado.value = 'Liberado';
            opcaoLiberado.text = 'Liberado';
            select.appendChild(opcaoLiberado);
            var opcaoEmAtendimento = document.createElement('option');
            opcaoEmAtendimento.value = 'Em Atendimento';
            opcaoEmAtendimento.text = 'Em Atendimento';
            select.appendChild(opcaoEmAtendimento);
            celulaStatus.appendChild(select);
            var celulaLogin = linha.insertCell(-1);
            celulaLogin.contentEditable = 'true';
            var celulaObservacao = linha.insertCell(-1);
            celulaObservacao.contentEditable = 'true';
            var celulaAcoes = linha.insertCell(-1);
            celulaAcoes.className = 'acoes';
            var botaoOK = document.createElement('button');
            botaoOK.className = 'btn btn-primary';
            botaoOK.innerText = 'OK';
            botaoOK.onclick = function() { editar(this); };
            celulaAcoes.appendChild(botaoOK);
            var botaoExcluir = document.createElement('button');
            botaoExcluir.className = 'btn btn-danger';
            botaoExcluir.innerText = 'Excluir';
            botaoExcluir.onclick = function() { excluir(this); };
            celulaAcoes.appendChild(botaoExcluir);
        }
    </script>
</body>
</html>
